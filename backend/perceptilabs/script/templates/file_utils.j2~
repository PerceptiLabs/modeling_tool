{% macro load_numpy(path, tag) -%}
{% filter remove_lspaces(4) %}
    global matrix_{{tag}}
    matrix_{{tag}} = np.load("{{path}}").astype(np.float32)
    size_{{tag}} = len(matrix_{{tag}})
    
    def generator_{{tag}}():
        global matrix_{{tag}}        
        yield from matrix_{{tag}}
{% endfilter %}
{%- endmacro %}

{% macro load_csv(path, tag, lazy=False) -%}
{% filter remove_lspaces(8) %}
    {% if lazy %}
        df_{{tag}} = dd.read_csv("{{path}}").astype(np.float32)
        size_{{tag}} = len(df_{{tag}})
        
        def generator_{{tag}}():
            global df_{{tag}}                    
            for _, x in df_{{tag}}.iterrows():
                yield x.values

    {% else %}
        global df_{{tag}}    
        df_{{tag}} = pd.read_csv("{{path}}").astype(np.float32)
        size_{{tag}} = len(df_{{tag}})        
        
        def generator_{{tag}}():
            global df_{{tag}}                    
            for _, x in df_{{tag}}.iterrows():
                yield x.values        
    {% endif %}
{% endfilter %}
{%- endmacro %}
